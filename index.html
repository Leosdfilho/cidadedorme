<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cidade Dorme - Jogo Online</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/supabase/2.39.0/supabase.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .game-setup {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 16px;
        }

        .input-group input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
        }

        .game-area {
            display: none;
        }

        .game-info {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: rgba(255,255,255,0.15);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(5px);
        }

        .info-card h3 {
            margin-bottom: 10px;
            color: #ffd93d;
        }

        .players-list {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .player-item:hover {
            background: rgba(255,255,255,0.2);
        }

        .player-item.dead {
            opacity: 0.5;
            text-decoration: line-through;
        }

        .player-item.voted {
            background: rgba(255,107,107,0.3);
        }

        .role-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .role-card.mafia {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }

        .role-card.detective {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }

        .role-card.doctor {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .phase-indicator {
            text-align: center;
            font-size: 1.5rem;
            padding: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .phase-indicator.night {
            background: linear-gradient(135deg, #232526 0%, #414345 100%);
        }

        .phase-indicator.day {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .voting-area {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .chat-area {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .chat-input {
            display: flex;
            gap: 10px;
        }

        .chat-input input {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .game-log {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            max-height: 200px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .game-info {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌙 Cidade Dorme 🌙</h1>
            <p>Jogo de dedução e estratégia multiplayer</p>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="game-setup">
            <h2>Configurar Jogo</h2>
            <div class="input-group">
                <label>Seu Nome:</label>
                <input type="text" id="player-name" placeholder="Digite seu nome">
            </div>
            <div class="input-group">
                <label>Código da Sala (deixe vazio para criar nova):</label>
                <input type="text" id="room-code" placeholder="Ex: ABC123">
            </div>
            <button class="btn" onclick="joinOrCreateRoom()">Entrar/Criar Sala</button>
        </div>

        <!-- Waiting Room -->
        <div id="waiting-room" class="hidden">
            <div class="game-setup">
                <h2>Sala: <span id="current-room-code"></span></h2>
                <p>Compartilhe este código com outros jogadores!</p>
                
                <div class="players-list">
                    <h3>Jogadores Conectados:</h3>
                    <div id="waiting-players"></div>
                </div>

                <div class="input-group">
                    <label>Número de Mafiosos:</label>
                    <input type="number" id="mafia-count" value="1" min="1" max="3">
                </div>

                <button class="btn" onclick="startGame()" id="start-btn">Iniciar Jogo</button>
                <button class="btn btn-secondary" onclick="leaveRoom()">Sair da Sala</button>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="game-area">
            <div class="phase-indicator" id="phase-indicator">
                Preparando jogo...
            </div>

            <div class="game-info">
                <div class="info-card">
                    <h3>Fase</h3>
                    <div id="current-phase">Noite</div>
                </div>
                <div class="info-card">
                    <h3>Jogadores Vivos</h3>
                    <div id="alive-count">0</div>
                </div>
                <div class="info-card">
                    <h3>Seu Papel</h3>
                    <div id="player-role">Carregando...</div>
                </div>
            </div>

            <div class="role-card" id="role-description">
                <h3>Seu Papel</h3>
                <p id="role-text">Aguardando...</p>
            </div>

            <div class="players-list">
                <h3>Jogadores</h3>
                <div id="game-players"></div>
            </div>

            <div class="voting-area" id="voting-area">
                <h3>Votação</h3>
                <p id="voting-instruction">Clique em um jogador para votar</p>
                <div id="vote-buttons"></div>
                <button class="btn hidden" id="confirm-vote" onclick="confirmVote()">Confirmar Voto</button>
            </div>

            <div class="chat-area" id="chat-messages"></div>
            <div class="chat-input">
                <input type="text" id="chat-input" placeholder="Digite sua mensagem..." onkeypress="handleChatKeyPress(event)">
                <button class="btn" onclick="sendMessage()">Enviar</button>
            </div>

            <div class="game-log" id="game-log"></div>
        </div>

        <div id="loading-screen" class="loading hidden">
            <div class="spinner"></div>
            <p>Conectando ao servidor...</p>
        </div>
    </div>

    <script>
        // Configuração do Supabase
        const supabaseUrl = 'https://rcksiigfssolqmpfmtgi.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJja3NpaWdmc3NvbHFtcGZtdGdpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzODc1MjcsImV4cCI6MjA3MDk2MzUyN30.2iPZDyq4QkZSdIq9_BGdbfn5WvNGKIAgpfB0oyWYn5M'
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey)

        // Estado do jogo
        let gameState = {
            roomCode: null,
            playerName: null,
            playerId: null,
            playerRole: null,
            currentPhase: 'setup',
            isAlive: true,
            selectedVote: null,
            gameId: null
        }

        let players = []
        let gameSubscription = null

        // Funções principais
        async function joinOrCreateRoom() {
            const playerName = document.getElementById('player-name').value.trim()
            const roomCode = document.getElementById('room-code').value.trim().toUpperCase()

            if (!playerName) {
                alert('Digite seu nome!')
                return
            }

            // Verificar se Supabase está configurado
            if (supabaseUrl === 'YOUR_SUPABASE_URL' || supabaseKey === 'YOUR_SUPABASE_ANON_KEY') {
                alert('❌ ERRO: Configure suas credenciais do Supabase!\n\nVocê precisa:\n1. Criar um projeto no supabase.com\n2. Criar as tabelas do banco\n3. Substituir YOUR_SUPABASE_URL e YOUR_SUPABASE_ANON_KEY pelas suas credenciais reais\n\nQuer uma versão que funciona sem configuração? Me avise!')
                return
            }

            gameState.playerName = playerName
            showLoading(true)

            // Adicionar logs de debug
            console.log('🔧 Tentando conectar ao Supabase...')
            console.log('URL:', supabaseUrl)
            console.log('Nome do jogador:', playerName)
            console.log('Código da sala:', roomCode || 'Nova sala')

            try {
                // Testar conexão primeiro
                const { data: testData, error: testError } = await supabase
                    .from('rooms')
                    .select('count')
                    .limit(1)

                if (testError) {
                    console.error('❌ Erro de conexão:', testError)
                    throw new Error(`Erro de conexão com Supabase: ${testError.message}. Verifique se você criou as tabelas no banco.`)
                }

                console.log('✅ Conexão com Supabase OK!')

                if (roomCode) {
                    await joinRoom(roomCode)
                } else {
                    await createRoom()
                }
            } catch (error) {
                console.error('❌ Erro completo:', error)
                let errorMessage = 'Erro desconhecido'
                
                if (error.message) {
                    errorMessage = error.message
                } else if (error.details) {
                    errorMessage = error.details
                } else if (error.hint) {
                    errorMessage = error.hint
                }

                alert(`❌ ERRO AO CONECTAR:\n\n${errorMessage}\n\n🔧 Possíveis soluções:\n1. Verifique se criou as tabelas no Supabase\n2. Confirme se suas credenciais estão corretas\n3. Verifique se o projeto Supabase está ativo\n\nConsole: Abra F12 para ver mais detalhes`)
                showLoading(false)
            }
        }

        async function createRoom() {
            const roomCode = generateRoomCode()
            console.log('🎮 Criando nova sala:', roomCode)
            
            try {
                // Criar sala
                console.log('📝 Inserindo sala no banco...')
                const { data: room, error: roomError } = await supabase
                    .from('rooms')
                    .insert([{
                        code: roomCode,
                        host: gameState.playerName,
                        status: 'waiting',
                        created_at: new Date().toISOString()
                    }])
                    .select()
                    .single()

                if (roomError) {
                    console.error('❌ Erro ao criar sala:', roomError)
                    throw new Error(`Erro ao criar sala: ${roomError.message}. ${roomError.hint || ''}`)
                }

                console.log('✅ Sala criada:', room)

                // Adicionar jogador à sala
                console.log('👤 Adicionando jogador à sala...')
                const { data: player, error: playerError } = await supabase
                    .from('players')
                    .insert([{
                        room_id: room.id,
                        name: gameState.playerName,
                        is_host: true,
                        is_alive: true
                    }])
                    .select()
                    .single()

                if (playerError) {
                    console.error('❌ Erro ao adicionar jogador:', playerError)
                    throw new Error(`Erro ao adicionar jogador: ${playerError.message}. ${playerError.hint || ''}`)
                }

                console.log('✅ Jogador adicionado:', player)

                gameState.roomCode = roomCode
                gameState.playerId = player.id
                gameState.gameId = room.id

                console.log('🎉 Sala criada com sucesso! Estado:', gameState)
                showWaitingRoom()
                subscribeToGameUpdates()
            } catch (error) {
                console.error('❌ Erro em createRoom:', error)
                throw error
            }
        }

        async function joinRoom(roomCode) {
            // Buscar sala
            const { data: room, error: roomError } = await supabase
                .from('rooms')
                .select('*')
                .eq('code', roomCode)
                .eq('status', 'waiting')
                .single()

            if (roomError || !room) {
                throw new Error('Sala não encontrada ou já iniciada')
            }

            // Verificar se nome já existe na sala
            const { data: existingPlayer } = await supabase
                .from('players')
                .select('*')
                .eq('room_id', room.id)
                .eq('name', gameState.playerName)

            if (existingPlayer && existingPlayer.length > 0) {
                throw new Error('Nome já em uso nesta sala')
            }

            // Adicionar jogador à sala
            const { data: player, error: playerError } = await supabase
                .from('players')
                .insert([{
                    room_id: room.id,
                    name: gameState.playerName,
                    is_host: false,
                    is_alive: true
                }])
                .select()
                .single()

            if (playerError) throw playerError

            gameState.roomCode = roomCode
            gameState.playerId = player.id
            gameState.gameId = room.id

            showWaitingRoom()
            subscribeToGameUpdates()
        }

        async function startGame() {
            const mafiaCount = parseInt(document.getElementById('mafia-count').value)
            
            if (players.length < 4) {
                alert('Mínimo 4 jogadores necessários!')
                return
            }

            if (mafiaCount >= players.length) {
                alert('Muitos mafiosos para poucos jogadores!')
                return
            }

            // Distribuir papéis
            const roles = assignRoles(players.length, mafiaCount)
            
            // Atualizar sala para iniciada
            await supabase
                .from('rooms')
                .update({ 
                    status: 'playing',
                    current_phase: 'night',
                    phase_start: new Date()
                })
                .eq('id', gameState.gameId)

            // Atualizar jogadores com papéis
            for (let i = 0; i < players.length; i++) {
                await supabase
                    .from('players')
                    .update({ role: roles[i] })
                    .eq('id', players[i].id)
            }

            addGameLog('🎮 Jogo iniciado! A cidade adormece...')
        }

        function assignRoles(playerCount, mafiaCount) {
            const roles = []
            
            // Adicionar mafiosos
            for (let i = 0; i < mafiaCount; i++) {
                roles.push('mafia')
            }
            
            // Adicionar papéis especiais se houver jogadores suficientes
            if (playerCount >= 5) roles.push('detective')
            if (playerCount >= 6) roles.push('doctor')
            
            // Preencher com cidadãos
            while (roles.length < playerCount) {
                roles.push('citizen')
            }
            
            // Embaralhar
            return roles.sort(() => Math.random() - 0.5)
        }

        async function subscribeToGameUpdates() {
            // Inscrever-se para mudanças na sala
            gameSubscription = supabase
                .channel(`room_${gameState.gameId}`)
                .on('postgres_changes', {
                    event: '*',
                    schema: 'public',
                    table: 'players',
                    filter: `room_id=eq.${gameState.gameId}`
                }, handlePlayerUpdate)
                .on('postgres_changes', {
                    event: '*',
                    schema: 'public',
                    table: 'rooms',
                    filter: `id=eq.${gameState.gameId}`
                }, handleRoomUpdate)
                .on('postgres_changes', {
                    event: 'INSERT',
                    schema: 'public',
                    table: 'game_messages'
                }, handleNewMessage)
                .subscribe()

            loadPlayers()
        }

        async function loadPlayers() {
            const { data } = await supabase
                .from('players')
                .select('*')
                .eq('room_id', gameState.gameId)
                .order('created_at')

            players = data || []
            updatePlayersDisplay()
        }

        function handlePlayerUpdate(payload) {
            loadPlayers()
        }

        function handleRoomUpdate(payload) {
            const room = payload.new
            if (room.status === 'playing' && gameState.currentPhase === 'setup') {
                showGameScreen()
                loadPlayerRole()
            }
            
            if (room.current_phase !== gameState.currentPhase) {
                gameState.currentPhase = room.current_phase
                updatePhaseDisplay()
            }
        }

        function handleNewMessage(payload) {
            if (payload.new.room_id === gameState.gameId) {
                displayMessage(payload.new)
            }
        }

        async function loadPlayerRole() {
            const { data: player } = await supabase
                .from('players')
                .select('role')
                .eq('id', gameState.playerId)
                .single()

            if (player) {
                gameState.playerRole = player.role
                updateRoleDisplay()
            }
        }

        function updatePlayersDisplay() {
            const waitingContainer = document.getElementById('waiting-players')
            const gameContainer = document.getElementById('game-players')
            
            if (gameState.currentPhase === 'setup') {
                waitingContainer.innerHTML = players.map(p => 
                    `<div class="player-item">
                        ${p.name} ${p.is_host ? '👑' : ''}
                    </div>`
                ).join('')
                
                // Só host pode iniciar
                const startBtn = document.getElementById('start-btn')
                const currentPlayer = players.find(p => p.id === gameState.playerId)
                startBtn.style.display = currentPlayer?.is_host ? 'block' : 'none'
            } else {
                gameContainer.innerHTML = players.map(p => 
                    `<div class="player-item ${!p.is_alive ? 'dead' : ''}">
                        <span>${p.name} ${!p.is_alive ? '💀' : '❤️'}</span>
                        <button class="btn btn-secondary ${gameState.currentPhase !== 'day' ? 'hidden' : ''}" 
                                onclick="selectVote('${p.id}')" 
                                ${!p.is_alive || p.id === gameState.playerId ? 'disabled' : ''}>
                            Votar
                        </button>
                    </div>`
                ).join('')
            }

            document.getElementById('alive-count').textContent = 
                players.filter(p => p.is_alive).length
        }

        function updateRoleDisplay() {
            const roleNames = {
                'mafia': 'Mafioso',
                'detective': 'Detetive', 
                'doctor': 'Médico',
                'citizen': 'Cidadão'
            }

            const roleDescriptions = {
                'mafia': 'Você é da MÁFIA! Elimine os cidadãos durante a noite. Vença quando só restarem mafiosos.',
                'detective': 'Você é o DETETIVE! Durante a noite, investigue um jogador para saber se é mafioso.',
                'doctor': 'Você é o MÉDICO! Durante a noite, proteja um jogador da eliminação.',
                'citizen': 'Você é um CIDADÃO! Durante o dia, vote para eliminar suspeitos de serem mafiosos.'
            }

            document.getElementById('player-role').textContent = roleNames[gameState.playerRole] || 'Carregando...'
            document.getElementById('role-text').textContent = roleDescriptions[gameState.playerRole] || 'Aguardando...'
            
            const roleCard = document.getElementById('role-description')
            roleCard.className = `role-card ${gameState.playerRole}`
        }

        function updatePhaseDisplay() {
            const phaseIndicator = document.getElementById('phase-indicator')
            const currentPhaseEl = document.getElementById('current-phase')
            
            const phaseNames = {
                'night': '🌙 Fase da Noite',
                'day': '☀️ Fase do Dia',
                'voting': '🗳️ Votação'
            }
            
            phaseIndicator.textContent = phaseNames[gameState.currentPhase] || 'Preparando...'
            phaseIndicator.className = `phase-indicator ${gameState.currentPhase}`
            currentPhaseEl.textContent = phaseNames[gameState.currentPhase] || 'Preparando...'
            
            updatePlayersDisplay()
        }

        function selectVote(playerId) {
            gameState.selectedVote = playerId
            document.getElementById('confirm-vote').classList.remove('hidden')
            
            // Destacar jogador selecionado
            document.querySelectorAll('.player-item').forEach(el => el.classList.remove('voted'))
            document.querySelector(`button[onclick="selectVote('${playerId}')"]`)
                .closest('.player-item').classList.add('voted')
        }

        async function confirmVote() {
            if (!gameState.selectedVote) return
            
            try {
                await supabase
                    .from('votes')
                    .insert([{
                        room_id: gameState.gameId,
                        voter_id: gameState.playerId,
                        target_id: gameState.selectedVote,
                        phase: gameState.currentPhase
                    }])
                
                document.getElementById('confirm-vote').classList.add('hidden')
                addGameLog(`Você votou!`)
            } catch (error) {
                console.error('Erro ao votar:', error)
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input')
            const message = input.value.trim()
            
            if (!message) return
            
            try {
                await supabase
                    .from('game_messages')
                    .insert([{
                        room_id: gameState.gameId,
                        player_name: gameState.playerName,
                        message: message,
                        phase: gameState.currentPhase
                    }])
                
                input.value = ''
            } catch (error) {
                console.error('Erro ao enviar mensagem:', error)
            }
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage()
            }
        }

        function displayMessage(messageData) {
            const chatArea = document.getElementById('chat-messages')
            const messageEl = document.createElement('div')
            messageEl.innerHTML = `
                <strong>${messageData.player_name}:</strong> ${messageData.message}
                <small style="opacity: 0.7">(${new Date(messageData.created_at).toLocaleTimeString()})</small>
            `
            chatArea.appendChild(messageEl)
            chatArea.scrollTop = chatArea.scrollHeight
        }

        function addGameLog(message) {
            const logArea = document.getElementById('game-log')
            const logEntry = document.createElement('div')
            logEntry.innerHTML = `<small>${new Date().toLocaleTimeString()}</small> ${message}`
            logArea.appendChild(logEntry)
            logArea.scrollTop = logArea.scrollHeight
        }

        async function leaveRoom() {
            if (gameSubscription) {
                gameSubscription.unsubscribe()
            }
            
            if (gameState.playerId) {
                await supabase
                    .from('players')
                    .delete()
                    .eq('id', gameState.playerId)
            }
            
            showSetupScreen()
        }

        function showSetupScreen() {
            document.getElementById('setup-screen').classList.remove('hidden')
            document.getElementById('waiting-room').classList.add('hidden')
            document.getElementById('game-screen').classList.add('hidden')
            showLoading(false)
        }

        function showWaitingRoom() {
            document.getElementById('setup-screen').classList.add('hidden')
            document.getElementById('waiting-room').classList.remove('hidden')
            document.getElementById('game-screen').classList.add('hidden')
            document.getElementById('current-room-code').textContent = gameState.roomCode
            showLoading(false)
        }

        function showGameScreen() {
            document.getElementById('setup-screen').classList.add('hidden')
            document.getElementById('waiting-room').classList.add('hidden')
            document.getElementById('game-screen').classList.remove('hidden')
            showLoading(false)
        }

        function showLoading(show) {
            document.getElementById('loading-screen').classList.toggle('hidden', !show)
        }

        function generateRoomCode() {
            return Math.random().toString(36).substr(2, 6).toUpperCase()
        }

        // Verificar se Supabase está configurado
        document.addEventListener('DOMContentLoaded', function() {
            if (supabaseUrl === 'YOUR_SUPABASE_URL' || supabaseKey === 'YOUR_SUPABASE_ANON_KEY') {
                // Mostrar aviso visual
                const setupScreen = document.getElementById('setup-screen')
                const warningDiv = document.createElement('div')
                warningDiv.innerHTML = `
                    <div style="background: linear-gradient(45deg, #ff6b6b, #ee5a52); padding: 20px; border-radius: 10px; margin-bottom: 20px; text-align: center;">
                        <h3>⚠️ CONFIGURAÇÃO NECESSÁRIA</h3>
                        <p>O jogo precisa ser configurado com Supabase para funcionar.</p>
                        <p><strong>Precisa de ajuda?</strong> Vou criar uma versão que funciona imediatamente!</p>
                        <button class="btn" onclick="showInstructions()" style="margin-top: 10px;">📖 Ver Instruções</button>
                        <button class="btn btn-secondary" onclick="requestOfflineVersion()" style="margin-top: 10px;">🎮 Versão Offline</button>
                    </div>
                `
                setupScreen.insertBefore(warningDiv, setupScreen.firstChild)
            }
        })

        function showInstructions() {
            alert(`🔧 INSTRUÇÕES DE CONFIGURAÇÃO:

1. Acesse supabase.com e crie um projeto gratuito
2. No painel do Supabase, vá em SQL Editor
3. Execute o código SQL que eu forneci para criar as tabelas
4. Vá em Settings → API e copie a URL e a chave pública
5. No seu código, substitua:
   - YOUR_SUPABASE_URL pela sua URL real
   - YOUR_SUPABASE_ANON_KEY pela sua chave real

Ou me peça uma versão que funciona sem configuração!`)
        }

        function requestOfflineVersion() {
            alert('💡 VERSÃO OFFLINE: Vou criar uma versão que funciona 100% no navegador, sem necessidade de configuração de servidor. Me avise e eu faço isso para você!')
        }
    </script>
</body>
</html>
